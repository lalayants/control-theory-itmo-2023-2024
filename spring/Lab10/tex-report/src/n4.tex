\subsection{Задание 4. Синтез LQG}

\subsubsection{Теория}
В этом задании выводится наблюдатель регулятор для системы:
\[
        \begin{cases}
                \dot{x} = A x + B  K \hat{x} + f \\
                y = Cx + DK\hat{x} + \xi \\
                \dot{\hat{x}} = A \hat{x} + B  K \hat{x} + L(\hat{y} - y) \\
                \hat{y} = C \hat{x} + D K \hat{x} \\
                \hat{x} = x - e \\
        \end{cases} \rightarrow
        \begin{cases}
            \begin{bmatrix} 
                \dot{x} \\
                \dot{e}
            \end{bmatrix} = 
            A_{new}
            \begin{bmatrix} 
              x \\
              e
            \end{bmatrix} 
          + B_{new} 
          \begin{bmatrix} 
            f \\
            \xi
          \end{bmatrix} 
            \\
            A_{new} = 
            \begin{bmatrix} 
                A + BK & -BK\\
                0 & A + LC
            \end{bmatrix} \\
            B_{new} = 
            \begin{bmatrix} 
                I & 0\\
                I & L
            \end{bmatrix} \in R^{2n \times (n + m)}
         \end{cases}
\]

\subsubsection{Результаты}
\[Q = 1; R = 1; L = \begin{bmatrix}
  -12.29 & -0.54\\
   3.19 & -1.35\\
  -7.98 &  0.26\\
   4.65 & -1.33
 \end{bmatrix}\]
 \[spec(A+LC) = [-11.04+0.j    -0.54+2.97j  -0.54-2.97j  -3.03+0.j  ]\]
 \[Q = 1; R = 1; K= \begin{bmatrix}
   1.20 & -10.88 & -3.57 &  6.80\\
   -0.00 &  -0.00 &  -0.00 &  -0.00
 \end{bmatrix}\]
 \[spec(A + BK) = \begin{bmatrix}
  -0.29 + 2.68j & -0.29 + -2.68j & -3.90 + 0.00j & -6.70 + 0.00j
 \end{bmatrix}\]
По результат (рис. \ref{fig:task4}) явно видно, что все сработало как надо.

\begin{figure}[ht!]
    \centering
    \includegraphics[width=\textwidth]{src/figs/task4_states.jpg}
    \caption{Результаты моделирования.}
    \label{fig:task4}
\end{figure}




\FloatBarrier

