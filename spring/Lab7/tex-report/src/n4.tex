\subsection{Задание 4}
\subsubsection{Принадлежность состояния ненаблюдаемому подпространству}
В этом задании дополнительно лишь нужно знать, как проверить состояние на принадлежность ненаблюдаемому подпространству.

Для этого необходимо проверить равенство \(Vx = 0\). Если это так -- состояние ненаблюдаемое.

Соответсвенно, базис ненаблюдаемого подпространства равен \(Nullspace(V)\).


\subsubsection{Результаты}
Вариант задания:
\[ A = \begin{bmatrix}
        -21 & -38 & 6 \\
        8 & 13 & -4 \\
        -6 & -14 & -1 \\
        \end{bmatrix}; 
        C = \begin{bmatrix}
                7 & 14 & 0
                \end{bmatrix}; 
        y = 3 e^{-5x}\cos{2x} - e^{-5x}\sin{2x}; 
        t_1 = 3
\]

Матрица наблюдаемости V:
\[ V = \begin{bmatrix}
        7 & 14 & 0 \\
        -35 & -84 & -14 \\
        147 & 434 & 140 \\
        \end{bmatrix};
\]
\[rankV = 2 = n \rightarrow \text{система  неполностью наблюдаема.}\]

Получены собственные числа \(spec(A) = [-5+2j, -5 -2j, 1+0j]\). Третье из них ненаблюдаемо, что еще раз подчеркивает ненаблюдаемость системы.

Так же рассмотрим наблюдаемость собственных чисел через форму Жордана:
\[
        J = \begin{bmatrix}
                1 & 0 & 0 \\
                0 & -5 - 2j & 0 \\
                0 & 0 & -5 + 2j \\
                \end{bmatrix};
        \hat{C} = \begin{bmatrix}
                0 &
                -3.5 + 3.5j &
                -3.5 - 3.5j \\
                \end{bmatrix};
\]
Как видно, у первого числа соотвествующий элемент в векторе наблюдения 0. Это еще раз подтверждает его ненаблюдаемость.

Получен Грамиан управляемости:
\[
        P(t_1) = \begin{bmatrix}
        4.56 & 8.27 & -0.84 \\
        8.27 & 15.2 & -1.35 \\
        -0.84 & -1.35 & 0.33 \\
        \end{bmatrix};
\]
\[
        spec(P(t_1)) = [19.8,  0.25, 0]
\]
Одно из собственных чисел Грамиана -- 0, поэтому он не положительно определен, а значит пара ненаблюдаема.

На рисунке \ref{fig:task4} приведены результаты моделирования системы. Как видно, при моделировании она действительно пришла в нужный вектор наблюдения за отведенное время.
\begin{figure}[ht!]
        \centering
        \includegraphics[width=\textwidth]{src/figs/task4.jpg}
        \caption{Результаты моделирования задания 4.}
        \label{fig:task4}
\end{figure}

Так как система не полностью наблюдаема, могут быть иные начальные состояний, приводящие к такому же наблюдению. Для их нахождения найдем базис \(Nullspace(V)\). Так как, ранг матрицы наблюдения 2, а размерность матрицы системы 3, базис нулевого подпространства будет представлять из себя прямую, задаваемую одним вектором \([-0.81, 0.41, -0.41]\).
На рисунке \ref{fig:task4_null} видно, что несмотря на различные начальные условия и поведение состояний, наблюдения полностью совпадают.
\begin{figure}[ht!]
        \centering
        \includegraphics[width=\textwidth]{src/figs/task4_nullspace.jpg}
        \caption{Результаты моделирования ненаблюдаемого подпространства задания 4.}
        \label{fig:task4_null}
\end{figure}

% \begin{cases}
%     \dot{x} = P J P^{-1} x + Bu \\
%     y = Cx + Du \\
% \end{cases},