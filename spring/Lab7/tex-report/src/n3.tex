\subsection{Задание 3}
Имеем систему:
\[
\begin{cases}
    \dot{x} = A x \\
    y = Cx  \\
\end{cases}
\]
\[
        y(t) = C e^{At} x(0)
\]
\subsubsection{Наблюдаемость через матрицу наблюдаемости}
\(V = [C | CA | \hdots | CA^{n-1}]^T\) для \(A \in R^{n \times n}\) и \(C \in R^{k \times n}\) -- матрица наблюдаемости системы. Если ее ранг равен \(n\) -- система наблюдаема.

\subsubsection{Наблюдаемость и Грамиан наблюдаемости}
\[Q(t_1) = \int_0^{t_1} e^{A^T t} C^T C e^{A t} dt\]
У наблюдаемой системы Грамиан наблюдаемости положительно определен в любой момент t.

\subsubsection{Управляемость через собственные числа матрицы системы}
\[\forall \lambda \in spec(A): rank(\begin{bmatrix}
        A - \lambda I  \\
        C \\
        \end{bmatrix}) = n \Longleftrightarrow \text{Матрица наблюдаема} \]

\subsubsection{Управляемость через Жорданову форму}
Жорданова форма матрицы \(A = P J P^{-1}\):
\[
        \begin{cases}
                \dot{x} = P J P^{-1} x \\
                y = Cx  \\
        \end{cases}
\]

Пусть \(\hat{x} = P^{-1}x\), тогда получим Жорданову форму системы:
\[
        \begin{cases}
                \dot{\hat{x}} = J\hat{x} \\
                y = CP\hat{x} = \hat{C}\hat{x} \\
        \end{cases}
\]

Система в Жордановой форме полностью наблюдаема, если:
\begin{itemize}
    \item каждому собственному числу соответсвует только одна Жорданова клетка. 
    \item элементы матрицы выходов, соответсвующие первым столбцам клеток -- не нулевые.
\end{itemize}

\subsubsection{Начальные условия системы}
Для вычисления начальных условий системы, достаточно рассчитать:
\[x(0) = (P(t_1))^{-1} \int_{0}^{t_1} e^{A^T t} C^T y(t) dt\]


\subsubsection{Результаты}
Вариант задания:
\[ A = \begin{bmatrix}
        -21 & -38 & 6 \\
        8 & 13 & -4 \\
        -6 & -14 & -1 \\
        \end{bmatrix}; 
        C = \begin{bmatrix}
                9  & 8 & -2
                \end{bmatrix}; 
        y = 3 e^{-5x}\cos{2x} - e^{-5x}\sin{2x}; 
        t_1 = 3
\]

Матрица наблюдаемости V:
\[ V = \begin{bmatrix}
        9 & 8 & -2 \\
        -113 & -210 & 24 \\
        549 & 1228 & 138 \\
        \end{bmatrix};
\]
\[rankU = V = n \rightarrow \text{система наблюдаема.}\]

Получены собственные числа \(spec(A) = [-5 + 2j, -5 - 2j, 1+0j]\). Каждое из них наблюдаемо, что еще раз показывает наблюдаемость системы.

Так же рассмотрим наблюдаемость собственных чисел через форму Жордана:
\[
        J = \begin{bmatrix}
                1 & 0 & 0 \\
                0 & -5 - 2j & 0 \\
                0 & 0 & -5 + 2j \\
                \end{bmatrix};
        \hat{C} = \begin{bmatrix}
                8 &
                17 + 10j &
                17 - 10j \\
                \end{bmatrix};
\]
Как видно, условия выполнены -- еще одно подтверждение, что пара (A, C) наблюдаема.

Получен Грамиан наблюдаемости:
\[
        Q(t_1) = \begin{bmatrix}
        12861 & 25733 & -12846\\
        25733 & 51508 & -25706 \\
        -12846 & -25706 & 12835 \\
        \end{bmatrix};
\]
\[
        spec(P(t_1)) = [77197, 1.34, 6.40]
\]Грамиан положительно определен, система полностью наблюдаема.

На рисунке \ref{fig:task3} приведены результаты моделирования системы. Как видно, при моделировании она действительно пришла в нужный вектор наблюдения за отведенное время.
\begin{figure}[ht!]
        \centering
        \includegraphics[width=\textwidth]{src/figs/task3.jpg}
        \caption{Результаты моделирования задания 3.}
        \label{fig:task3}
\end{figure}
Так как система полностью наблюдаема, иных начальных состояние быть не может. Размерность \(Nullspace(V) = dimV - rankV = 0\). 
